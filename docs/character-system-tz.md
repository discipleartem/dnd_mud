# Техническое задание: Система создания персонажа MVP

## Обзор

Создание минимально жизнеспособной системы (MVP) для создания персонажа в D&D MUD игре с консольным интерфейсом.

## Требования

### 1. Функциональные требования

#### 1.1 Расы (MVP - 3 расы)
- **Человек**: универсальная раса, +1 ко всем характеристикам
- **Эльф**: 2 подвида
  - **Высокий эльф**: +2 к ловкости, +1 к интеллекту
  - **Лесной эльф**: +2 к ловкости, +1 к мудрости
- **Полуорк**: +2 к силе, +1 к телосложению

#### 1.2 Классы (MVP - 3 класса)
- **Воин**: +1 к силе, +1 к телосложению, d10 для HP
- **Волшебник**: +1 к интеллекту, +1 к мудрости, d6 для HP
- **Плут**: +1 к ловкости, +1 к харизме, d8 для HP

#### 1.3 Характеристики
- 6 основных характеристик: СИЛ, ЛОВ, ТЕЛ, ИНТ, МДР, ХАР
- Диапазон значений: 3-18 (стандартные правила D&D)
- Модификаторы: (значение - 10) // 2

#### 1.4 Процесс создания персонажа
1. Выбор расы
2. Выбор класса
3. Генерация характеристик (4d6 drop lowest)
4. Применение расовых бонусов
5. Расчет производных характеристик (HP, AC)
6. Подтверждение и сохранение

### 2. Технические требования

#### 2.1 Архитектура
- **Core слой**: `src/core/entities/`
  - `character.py` - класс персонажа
  - `race.py` - классы рас
  - `class.py` - классы классов
- **Mechanics слой**: `src/core/mechanics/`
  - `dice.py` - система кубиков
  - `attributes.py` - генерация характеристик
- **UI слой**: `src/ui/menus/`
  - `character_menu.py` - меню создания персонажа
  - `character_sheet.py` - отображение листа персонажа

#### 2.2 Данные
- YAML конфигурации рас и классов
- JSON сохранения персонажей
- Валидация данных через type hints

#### 2.3 Интерфейс
- Консольный вывод без Rich
- Числовая навигация по меню
- Цветовые сообщения для важных событий

### 3. Пользовательские сценарии

#### 3.1 Основной сценарий
```
1. Пользователь выбирает "Новая игра"
2. Открывается меню создания персонажа
3. Пользователь выбирает расу (1-3)
4. Пользователь выбирает класс (1-3)
5. Система генерирует характеристики
6. Пользователь видит итогового персонажа
7. Подтверждает или пересоздает
8. Сохранение в data/saves/
```

#### 3.2 Альтернативные сценарии
- Пересоздание персонажа
- Просмотр характеристик перед подтверждением
- Отмена и возврат в главное меню

## Реализация

### 1. Структура классов

#### 1.1 Character
```python
@dataclass
class Character:
    name: str
    race: str
    character_class: str
    level: int = 1
    
    # Характеристики
    strength: int
    dexterity: int
    constitution: int
    intelligence: int
    wisdom: int
    charisma: int
    
    # Производные
    hp_max: int
    hp_current: int
    ac: int
    gold: int = 10
```

#### 1.2 Race
```python
class Race:
    name: str
    bonuses: Dict[str, int]
    description: str
    
    def apply_bonuses(self, attributes: Dict[str, int]) -> Dict[str, int]
```

#### 1.3 CharacterClass
```python
class CharacterClass:
    name: str
    bonuses: Dict[str, int]
    hit_die: str  # "d10", "d6", "d8"
    description: str
    
    def calculate_hp(self, constitution: int) -> int
```

### 2. YAML конфигурации

#### 2.1 Расы
```yaml
# data/yaml/races/human.yaml
name: "Человек"
description: "Универсальная раса с бонусом ко всем характеристикам"
bonuses:
  strength: 1
  dexterity: 1
  constitution: 1
  intelligence: 1
  wisdom: 1
  charisma: 1
```

#### 2.2 Классы
```yaml
# data/yaml/classes/fighter.yaml
name: "Воин"
description: "Мастер боевых искусств и тяжелого оружия"
bonuses:
  strength: 1
  constitution: 1
hit_die: "d10"
```

### 3. UI компоненты

#### 3.1 Меню создания персонажа
```
=== СОЗДАНИЕ ПЕРСОНАЖА ===
1. Выбрать расу
2. Выбрать класс
3. Сгенерировать характеристики
4. Подтвердить создание
5. Назад

Введите номер пункта:
```

#### 3.2 Лист персонажа
```
=== АРТАС БОЕЦА ===
Имя: Артас
Уровень: 1 | Раса: Человек | Класс: Воин

Характеристики:
СИЛ: 16 (+3)
ЛОВ: 14 (+2)
ТЕЛ: 15 (+2)
ИНТ: 12 (+1)
МДР: 13 (+1)
ХАР: 11 (+0)

Боевые параметры:
HP: 12/12
AC: 12
Золото: 10 монет
```

## Критерии приемки

### 1. Функциональность
- [ ] Создание персонажа с 3 расами и 3 классами
- [ ] Генерация характеристик по правилам D&D
- [ ] Применение расовых и классовых бонусов
- [ ] Сохранение персонажа в JSON
- [ ] Отображение листа персонажа
- [ ] Удобный доступ к характеристикам через `character.STR`, `character.DEX` и т.д.

### 2. Качество кода
- [ ] Type hints везде
- [ ] Docstrings на русском языке
- [ ] Соблюдение PEP 8
- [ ] Обработка ошибок
- [ ] Логирование действий

### 3. UX/UI
- [ ] Понятная навигация
- [ ] Цветовые сообщения об успехах/ошибках
- [ ] Симметричное отображение рамок
- [ ] Валидация пользовательского ввода

## Рекомендации по реализации

### 1. Порядок разработки
1. Создать базовые классы (Character, Race, CharacterClass)
2. Реализовать загрузку YAML конфигураций
3. Создать систему генерации характеристик
4. Разработать UI меню создания персонажа
5. Добавить сохранение/загрузку
6. Тестирование и отладка

### 2. Паттерны для использования
- **Factory Pattern** для создания персонажей
- **Repository Pattern** для загрузки YAML
- **Template Method** для процесса создания
- **Strategy Pattern** для разных рас/классов

### 3. Менторские советы
- Начинайте с простого, усложняйте постепенно
- Используйте dataclass для Character
- Выделяйте бизнес-логику в отдельные методы
- Добавляйте логирование для отладки
- Тестируйте каждую компоненту отдельно

## Следующие шаги

После реализации MVP:
1. Расширение до 6 рас и 6 классов
2. Добавление навыков и способностей
3. Интеграция с боевой системой
4. Создание системы сохранений
5. Добавление модульности

Это ТЗ обеспечивает создание работающей MVP системы персонажа с возможностью дальнейшего расширения.