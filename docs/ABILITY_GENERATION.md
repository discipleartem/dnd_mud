# Генерация характеристик персонажа

## Обзор

Система генерации характеристик реализована в модуле `src/ui/main_menu/ability_generation.py` и поддерживает три метода генерации согласно правилам D&D 5e.

## Методы генерации

### 1. Стандартный массив

- **Значения:** 15, 14, 13, 12, 10, 8
- **Процесс:** Игрок выбирает по одному значению для каждой характеристики
- **Преимущества:** Сбалансированный персонаж, простой процесс

### 2. Покупка очков

- **Очки:** 27 очков на распределение
- **Диапазон значений:** 8-15 (стоимость возрастает)
- **Стоимость:**
  - 8: 0 очков
  - 9: 1 очко
  - 10: 2 очка
  - 11: 3 очка
  - 12: 4 очка
  - 13: 5 очков
  - 14: 7 очков
  - 15: 9 очков
- **Преимущества:** Полный контроль над характеристиками

### 3. Случайная генерация

- **Метод:** 4d6 - отбросить наименьший, суммировать остальные
- **Процесс:** Генерируется 6 значений, игрок распределяет их по характеристикам
- **Hardcore режим:** Значения распределяются автоматически
- **Преимущества:** Создание уникальных персонажей

## Учет расовых бонусов

Система автоматически учитывает бонусы от расы и подрасы:

1. **Отображение бонусов:** Перед генерацией показываются все бонусы
2. **Применение:** Бонусы добавляются к базовым значениям
3. **Итоговые значения:** Отображаются базовое значение + бонус + итог

## Структура кода

### Основные классы

- `AbilityScores`: Хранение и управление характеристиками
- `Ability`: Enum шести характеристик D&D
- `StandardArray`: Стандартный массив значений
- `PointBuySystem`: Система покупки очков
- `RandomGeneration`: Случайная генерация
- `DiceRoller`: Утилита для бросков костей

### UI функции

- `generate_ability_scores()`: Основная функция генерации
- `generate_standard_array()`: Стандартный массив
- `generate_point_buy()`: Покупка очков
- `generate_random_scores()`: Случайная генерация
- `display_racial_bonuses()`: Отображение бонусов расы

## Интеграция с Character

Класс `Character` обновлен для хранения характеристик:

```python
@dataclass
class Character:
    # ... другие поля
    ability_scores: Optional[AbilityScores] = None
```

## Локализация

Все текстовые строки локализованы в `localization/ru.yaml` в секции `ability_generation`.

## Использование

```python
from src.ui.main_menu.ability_generation import generate_ability_scores

# Генерация характеристик для персонажа
ability_scores = generate_ability_scores(
    race=selected_race,
    subrace=selected_subrace,
    hardcore_mode=False
)

# Добавление к персонажу
character.ability_scores = ability_scores
```

## Hardcore режим

При включении hardcore режима (из настроек), случайная генерация происходит без выбора игрока - значения автоматически распределяются по характеристикам.

## Валидация

- Значения характеристик: 1-20
- Покупка очков: проверка доступности очков
- Расовые бонусы: автоматическое применение с валидацией
