# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏

–ü—Ä–æ–±–ª–µ–º–∞: `make test` —Å–∂–∏—Ä–∞–ª–∞ –≤—Å—é –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å –∏–∑-–∑–∞:
- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤ `while True` –≤ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- **–û—Å–æ–±–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** `test_run_general_exception` –∑–∞–≤–∏—Å–∞–ª –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ
- –ù–∞–∫–æ–ø–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ —Ç–µ—Å—Ç–∞—Ö
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ singleton'–æ–≤ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤

## ‚úÖ –ö–æ—Ä–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã:
- `input_handler.py` - –≤—Å–µ –º–µ—Ç–æ–¥—ã –≤–≤–æ–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã 10 –ø–æ–ø—ã—Ç–∫–∞–º–∏
- `character_menu.py` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ 10 –ø–æ–ø—ã—Ç–∫–∞–º–∏ –≤–≤–æ–¥–∞ –∏ 5 –ø–æ–ø—ã—Ç–∫–∞–º–∏ —Å–æ–∑–¥–∞–Ω–∏—è
- `character_creation.py` - point_buy –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 50 –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏
- `main_menu.py` - –º–µ–Ω—é –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ 20 –ø–æ–∫–∞–∑–∞–º–∏
- **üî• –ö–†–ò–¢–ò–ß–ù–û:** `character_creation.py:run()` - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 20 –ø–æ–ø—ã—Ç–∫–∞–º–∏

### 2. –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —É—Ç–µ—á–∫–∞ –≤ `test_run_general_exception`:
```python
# –ë–´–õ–û (–±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏):
while self.current_step != CreationStep.CONFIRMATION:
    try:
        self._handle_current_step()  # –í—ã–∑—ã–≤–∞–ª –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
    except Exception as e:
        self.renderer.render_error(f"–û—à–∏–±–∫–∞: {e}")
        self.input_handler.wait_for_enter()
        # –®–∞–≥ –Ω–µ –º–µ–Ω—è–ª—Å—è -> –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª!

# –°–¢–ê–õ–û (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
max_attempts = 20
attempts = 0
while self.current_step != CreationStep.CONFIRMATION and attempts < max_attempts:
    attempts += 1
    try:
        self._handle_current_step()
    except Exception as e:
        self.renderer.render_error(f"–û—à–∏–±–∫–∞: {e}")
        self.input_handler.wait_for_enter()
        # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ 20 –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫—É
```

### 3. –£–ª—É—á—à–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏:
- –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ singleton'–æ–≤ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
- –°–±—Ä–æ—Å –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ UI (renderer, input_handler)
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

### 4. –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û - –±–æ–ª—å—à–µ –Ω–µ —Å—ä–µ–¥–∞–µ—Ç –ø–∞–º—è—Ç—å!
make test

# ‚úÖ –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ:
make test-safe          # –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã
make test-sequential    # –ü–æ—à–∞–≥–æ–≤—ã–π –∑–∞–ø—É—Å–∫  
make test-strict        # –° –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏ 512MB
make test-monitor       # –° –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –ø–∞–º—è—Ç–∏
```

## –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### üîÑ –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã:
```python
# –ë–´–õ–û (—É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏):
while True:
    user_input = input(...)
    # –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª

# –°–¢–ê–õ–û (–±–µ–∑–æ–ø–∞—Å–Ω–æ):
max_attempts = 10
attempts = 0
while attempts < max_attempts:
    attempts += 1
    user_input = input(...)
    # –º–∞–∫—Å–∏–º—É–º 10 –ø–æ–ø—ã—Ç–æ–∫
```

### üßπ –£–ª—É—á—à–µ–Ω–∞ –æ—á–∏—Å—Ç–∫–∞ –≤ —Ç–µ—Å—Ç–∞—Ö:
```python
# conftest.py - –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ singleton'–æ–≤
@pytest.fixture(autouse=True)
def cleanup_singletons():
    yield
    # –û—á–∏—â–∞–µ–º CharacterManager, localization, UI –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã
```

### üìÅ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```python
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
if self.temp_dir.exists():
    try:
        shutil.rmtree(self.temp_dir, ignore_errors=True)
    except Exception:
        pass
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- ‚úÖ `make test` —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
- ‚úÖ `test_run_general_exception` –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–∞ 0.08—Å (–±—ã–ª –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º)
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü–∞–º—è—Ç—å –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
- ‚úÖ –ù–µ—Ç –∑–∞–≤–∏—Å—à–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

**–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –≤ `test_run_general_exception` –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞!** üéâ
