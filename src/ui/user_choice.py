"""
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ú–æ–¥—É–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é get_user_choice, –∫–æ—Ç–æ—Ä–∞—è –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è 
–ø–æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.
"""

from typing import List, Optional, Tuple, Union


def get_user_choice(
    items: Union[Tuple[str, ...], List[str]], 
    title: str = "",
    prompt: Optional[str] = None,
    allow_cancel: bool = False,
    cancel_text: str = "–û—Ç–º–µ–Ω–∞"
) -> Optional[int]:
    """–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    
    Args:
        items: –°–ø–∏—Å–æ–∫ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞
        title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ –º–µ–Ω—é
        prompt: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ç–µ–∫—Å—Ç –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è. –ï—Å–ª–∏ None, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
        allow_cancel: –†–∞–∑—Ä–µ—à–∏—Ç—å –ª–∏ –æ—Ç–º–µ–Ω—É –≤—ã–±–æ—Ä–∞ (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç None)
        cancel_text: –¢–µ–∫—Å—Ç –¥–ª—è –ø—É–Ω–∫—Ç–∞ –æ—Ç–º–µ–Ω—ã
        
    Returns:
        –ù–æ–º–µ—Ä –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (1-based) –∏–ª–∏ None –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ
        
    Raises:
        ValueError: –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        
    Examples:
        >>> choice = get_user_choice(["–î–∞", "–ù–µ—Ç"], "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ")
        >>> if choice == 1:
        ...     print("–í—ã–±—Ä–∞–Ω–æ: –î–∞")
        
        >>> choice = get_user_choice(["–í–æ–∏–Ω", "–ú–∞–≥", "–õ—É—á–Ω–∏–∫"], "–í—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞", allow_cancel=True)
        >>> if choice is None:
        ...     print("–í—ã–±–æ—Ä –æ—Ç–º–µ–Ω–µ–Ω")
        >>> elif choice == 2:
        ...     print("–í—ã–±—Ä–∞–Ω –∫–ª–∞—Å—Å: –ú–∞–≥")
    """
    if not items:
        raise ValueError("–°–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º")
    
    while True:
        print("\n" + "="*60)
        if title:
            print(title.center(60))
        print("="*60)
        
        # –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        for i, item in enumerate(items, 1):
            print(f"{i}. {item}")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—É–Ω–∫—Ç –æ—Ç–º–µ–Ω—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        if allow_cancel:
            cancel_index = len(items) + 1
            print(f"{cancel_index}. {cancel_text}")
            max_choice = cancel_index
        else:
            max_choice = len(items)
        
        print("="*60)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥–ª—è –≤–≤–æ–¥–∞
        if prompt is None:
            prompt_text = f"üéØ –í—ã–±–µ—Ä–∏—Ç–µ –ø—É–Ω–∫—Ç (1-{max_choice})"
        else:
            prompt_text = f"üéØ {prompt}"
            
        choice = input(f"{prompt_text}: ").strip()
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–º–µ–Ω—ã
        if allow_cancel and choice == str(cancel_index):
            return None
            
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∞
        if choice.isdigit() and 1 <= int(choice) <= len(items):
            return int(choice)  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º 1-based –∏–Ω–¥–µ–∫—Å
        else:
            print(f"‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä. –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ {max_choice}.")
